(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1230:function(e,t,n){var a,l;a=[n(7),n(263),n(427),n(1231),n(1235),n(1239),n(264),n(430),n(1241),n(1245),n(1247),n(1253)],void 0===(l=function(e,t,n,a,l,s,i,r,c,o,d,p){var _={title:"Imaging Schedules",url:"/admin/imaging"},u={imaging_dash:function(){app.user_can("imaging_dash")?(app.content.show(new s),app.bc.reset([{title:"Imaging Dashboard",url:"/admin/imaging"}])):app.message({title:"Access Denied",message:"You do not have access to that page"})},schedules:function(){if(app.user_can("schedules")){app.loading();var e=new n;e.fetch({success:function(t){app.content.show(new a({collection:e})),app.bc.reset([_,{title:"Manage Imaging Schedules",url:"/admin/imaging/schedules"}])},error:function(){app.message({title:"Couldn't load schedule list",message:"Couldn't load schedule list please try again"})}})}else app.message({title:"Access Denied",message:"You do not have access to that page"})},view_schedule:function(e){if(app.user_can("schedule_comps")){app.loading();var n=new t({SCHEDULEID:e});n.fetch({success:function(e){app.content.show(new l({model:n})),app.bc.reset([_,{title:"Manage Imaging Schedules",url:"/admin/imaging/schedule"},{title:n.get("NAME")}])},error:function(){app.message({title:"Couldn't load schedule",message:"Couldn't load schedule please try again"})}})}else app.message({title:"Access Denied",message:"You do not have access to that page"})},screens:function(){app.loading();var e=new r;e.fetch({success:function(t){app.content.show(new c({collection:e})),app.bc.reset([{title:"Crysallisation Screens",url:"/imaging/screen"}])},error:function(){app.message({title:"Couldn't load screens list",message:"Couldn't load screens list please try again"})}})},view_screen:function(e){app.loading();var t=new i({SCREENID:e});t.fetch({success:function(e){app.content.show(new o({model:t})),app.bc.reset([{title:"Crystallisation Screens",url:"/imaging/screen"},{title:t.get("NAME")}])},error:function(){app.message({title:"Couldn't load screen",message:"Couldn't load screen please try again"})}})},view_presets:function(){app.user_can("edit_presets")?(app.bc.reset([{title:"Manage Beamline Presets",url:"/admin/preset"}]),app.options.get("preset_proposal")?(app.cookie(app.options.get("preset_proposal")),app.content.show(new p)):app.message({title:"No Preset Proposal",message:"No preset proposal is defined to store presets in"})):app.message({title:"Access Denied",message:"You do not have access to that page"})},view_params:function(){app.user_can("manage_params")?(app.bc.reset([{title:"Manage Beamline Parameters",url:"/admin/params"}]),app.content.show(new d)):app.message({title:"Access Denied",message:"You do not have access to that page"})}};return app.addInitializer((function(){app.on("schedule:view",(function(e){app.navigate("/admin/imaging/schedule/"+e),u.view_schedule(e)})),app.on("screen:view",(function(e){app.navigate("/imaging/screen/"+e),u.view_screen(e)}))})),u}.apply(t,a))||(e.exports=l)},1231:function(e,t,n){(function(a,l){var s,i;s=[n(7),n(6),n(49),n(263),n(1232),n(1233),n(1234),n(18)],void 0===(i=function(e,t,n,s,i,r,c){var o=n.extend({getTemplate:function(){return this.model.get("new")?c:r},tagName:"tr",className:function(){return this.model.get("new")?"new":""},events:{"click td":"showSchedule","click a.cancel":"cancelSchedule","click a.save":"onSubmit"},ui:{name:"input[name=NAME]"},cancelSchedule:function(e){e.preventDefault(),this.model.collection.remove(this.model)},setData:function(){this.model.set({NAME:this.ui.name.val()})},success:function(e,t,n){this.model.set("new",!1),this.$el.removeClass("new"),this.render()},error:function(e,t,n){app.message("Something went wrong creating this schedule, please try again")},showSchedule:function(e){a(e.target).closest(".new").length||app.trigger("schedule:view",this.model.get("SCHEDULEID"))}}),d=e.ItemView.extend({tagName:"tr",template:l.template('<td colspan="4">No schedules found</td>')});return GridView=t.Marionette.CompositeView.extend({className:"content",template:i,childView:o,emptyView:d,childViewContainer:"tbody",events:{"click .add":"addSchedule"},addSchedule:function(e){e.preventDefault(),this.$el.find(".new").length||this.collection.add(new s({new:!0}))}})}.apply(t,s))||(e.exports=i)}).call(this,n(8),n(5))},1232:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1>Imaging Schedules</h1>\n\n<p class="help">This page lists all available imaging schedules.</p>\n\n<div class="ra"><a href="#" class="add button" title="Click to add a new schedule"><i class="fa fa-plus"></i> Add Schedule</a></div>\n\n\n<div class="table">\n    <table class="schedules">\n        <thead>\n            <tr>\n                <th>Name</th>\n                <th># Components</th>\n                <th># Containers</th>\n                <th>&nbsp;</th>\n            </tr>\n        </thead>\n        \n        <tbody></tbody>\n    </table>\n</div>';return __p}},1233:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='    <td class="NAME">'+(null==(__t=NAME)?"":_.escape(__t))+"</td>\n    <td>"+(null==(__t=SCHEDULECOMPONENTS)?"":_.escape(__t))+'</td>\n    <td class="CONTAINERS">'+(null==(__t=CONTAINERS)?"":_.escape(__t))+"</td>\n    <td>&nbsp;</td>\n";return __p}},1234:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <td><input name="NAME" type="text" /></td>\n    <td>&nbsp;</td>\n    <td>&nbsp;</td>\n    <td>\n        <a class="button button-notext save"><i class="fa fa-check"></i> <span>Save Schedule</span></a>\n        <a class="button button-notext cancel"><i class="fa fa-times"></i> <span>Cancel</span></a>\n    </td>\n\n';return __p}},1235:function(e,t,n){(function(a){var l,s;l=[n(7),n(6),n(49),n(20),n(429),n(428),n(269),n(1236),n(1237),n(1238),n(18)],void 0===(s=function(e,t,n,l,s,i,r,c,o,d){var p=n.extend({getTemplate:function(){return this.model.get("new")|this.model.get("edit")?d:o},tagName:"tr",className:function(){return this.model.get("new")?"new":""},events:{"click a.cancel":"cancelSchedule","click a.save":"onSubmit","click a.edit":"editSchedule"},ui:{type:"select[name=INSPECTIONTYPEID]"},editSchedule:function(e){e.preventDefault(),this.model.set({edit:!0}),this.render(),this.ui.type.val(this.model.get("INSPECTIONTYPEID"))},cancelSchedule:function(e){e.preventDefault(),this.model.get("edit")?(this.model.set({edit:!1}),this.render()):this.model.collection.remove(this.model)},setData:function(){var e=this.getOption("types").findWhere({INSPECTIONTYPEID:this.ui.type.val()});this.model.set({INSPECTIONTYPEID:this.ui.type.val(),INSPECTIONTYPE:e.get("NAME")})},success:function(e,t,n){this.model.set("new",!1),this.model.set("edit",!1),this.$el.removeClass("new"),this.render()},failure:function(e,t,n){app.alert({message:"Something went wrong creating this schedule component, please try again"})},onRender:function(){this.ui.type.html(this.getOption("types").opts()).val(this.model.get("INSPECTIONTYPEID"))}}),_=e.ItemView.extend({tagName:"tr",template:a.template('<td colspan="3">No components defined</td>')});return GridView=t.Marionette.CompositeView.extend({className:"content",template:c,childView:p,emptyView:_,childViewContainer:"tbody",childViewOptions:function(){return{types:this.types}},events:{"click .add":"addSchedule"},initialize:function(e){t.Validation.bind(this),this.collection=new i,this.collection.queryParams.shid=this.model.get("SCHEDULEID"),this.collection.fetch(),this.types=new r,this.types.fetch()},addSchedule:function(e){e.preventDefault(),this.$el.find(".new").length||this.collection.add(new s({new:!0,SCHEDULEID:this.model.get("SCHEDULEID")}))},onRender:function(){new l({model:this.model,el:this.$el}).create("NAME","text")}})}.apply(t,l))||(e.exports=s)}).call(this,n(5))},1236:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1>Imaging Schedule: <span class="NAME">'+(null==(__t=NAME)?"":_.escape(__t))+'</span></h1>\n\n<p class="help">This page lists details for the selected imaging schedule.</p>\n\n<div class="ra"><a href="#" class="add button" title="Click to add a new schedule component"><i class="fa fa-plus"></i> Add Component</a></div>\n<div class="table">\n    <table class="scomponents">\n        <thead>\n            <tr>\n                <th>Offset Hours</th>\n                <th>Inspection Type</th>\n                <th>&nbsp;</th>\n            </tr>\n        </thead>\n        \n        <tbody></tbody>\n    </table>\n</div>';return __p}},1237:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='    <td class="OFFSET_HOURS">'+(null==(__t=OFFSET_HOURS)?"":_.escape(__t))+'</td>\n    <td class="INSPECTIONTYPEID">'+(null==(__t=INSPECTIONTYPE)?"":_.escape(__t))+'</td>\n    <td>\n        <a class="button button-notext edit"><i class="fa fa-pencil"></i> <span>Edit</span></a>\n        <a class="button button-notext delete"><i class="fa fa-times"></i> <span>Delete</span></a>\n    </td>\n';return __p}},1238:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <td><input name="OFFSET_HOURS" type="text" value="'+(null==(__t=OFFSET_HOURS)?"":_.escape(__t))+'" /></td>\n    <td><select name="INSPECTIONTYPEID" type="text" /></select></td>\n    <td>\n        <a class="button button-notext save"><i class="fa fa-check"></i> <span>Save Schedule</span></a>\n        <a class="button button-notext cancel"><i class="fa fa-times"></i> <span>Cancel</span></a>\n    </td>\n\n';return __p}},1239:function(e,t,n){(function(a){var l,s;l=[n(7),n(16),n(432),n(173),n(80),n(118),n(31),n(12),n(15),n(1240)],void 0===(s=function(e,t,n,l,s,i,r,c,o,d){var p=o.ClickableRow.extend({event:"select:imager",argument:"IMAGERID"}),_=t.Row.extend({events:{click:"onClick"},onClick:function(e){a(e.target).is("i")||a(e.target).is("a")||a(e.target).hasClass("editable")||(this.model.get("PROP")&&app.cookie(this.model.get("PROP")),app.trigger("container:show",this.model.get("CONTAINERID"),this.model.get("CONTAINERINSPECTIONID")))}});return e.LayoutView.extend({className:"content",template:d,regions:{imgrs:".imagers",insp:".inspections",insf:".inspection_filter",ctrs:".ctrs"},initialize:function(e){this.imagers=new n,this.imagers.fetch(),this.inspections=new l,this.inspections.queryParams.all=1,this.inspections.queryParams.allStates=1,this.inspections.setSorting("BLTIMESTAMP",1),this.inspections.fetch(),this.containers=new s,this.containers.queryParams.imager=1,this.containers.queryParams.all=1,this.containers.fetch(),this.listenTo(app,"select:imager",this.selectImager,this)},selectImager:function(e){this.containers.queryParams.iid=e,this.containers.fetch()},onRender:function(){var e=[{name:"NAME",label:"Name",cell:"string",editable:!1},{name:"TEMPERATURE",label:"Temperature",cell:"string",editable:!1},{name:"SERIAL",label:"Serial",cell:"string",editable:!1},{name:"CAPACITY",label:"Capacity",cell:"string",editable:!1},{name:"PUSAGE",label:"Usage (%)",cell:"string",editable:!1}];this.imgrs.show(new c({collection:this.imagers,columns:e,tableClass:"imagers",loading:!0,pages:!1,backgrid:{emptyText:"No imagers found",row:p}}));e=[{name:"PROP",label:"Proposal",cell:"string",editable:!1},{name:"VISIT_NUMBER",label:"Visit",cell:"string",editable:!1},{name:"CONTAINER",label:"Container",cell:"string",editable:!1},{name:"CONTAINERID",label:"Container ID",cell:"string",editable:!1},{name:"CONTAINERINSPECTIONID",label:"Inspection ID",cell:"string",editable:!1},{name:"STATE",label:"State",cell:"string",editable:!1},{label:"Adhoc",cell:o.TemplateCell,editable:!1,template:"<%-SCHEDULECOMPONENTID ? 'No' : 'Yes' %>"},{label:"Manual",cell:o.TemplateCell,editable:!1,template:"<%-MANUAL == '1' ? 'Yes':'No' %>"},{name:"INSPECTIONTYPE",label:"Type",cell:"string",editable:!1},{name:"SCHEDULEDTIMESTAMP",label:"Scheduled",cell:"string",editable:!1},{name:"BLTIMESTAMP",label:"Started",cell:"string",editable:!1},{name:"DURATION",label:"Took (m)",cell:"string",editable:!1},{name:"DWELL",label:"Dwell (d)",cell:"string",editable:!1},{name:"AGE",label:"Age (d)",cell:"string",editable:!1},{label:"Scored",cell:o.TemplateCell,editable:!1,template:"<%-IMAGESSCORED == '1' ? 'Yes' : 'No' %>"}];this.insp.show(new c({collection:this.inspections,columns:e,tableClass:"inspections",loading:!0,filter:"s",backgrid:{emptyText:"No inspections found",row:_},noPageUrl:!0}));this.ty=new r({collection:this.inspections,filters:[{name:"Completed",id:"COMPLETED"},{name:"Incomplete",id:"INCOMPLETE"},{name:"Scheduled",id:"SCHEDULED"},{name:"Adhoc",id:"ADHOC"},{name:"Manual",id:"MANUAL"}],mobile:!0,url:!1,name:"ty"}),this.insf.show(this.ty),this.ctrs.show(new i({collection:this.containers,params:{},barcode:!0}))}})}.apply(t,l))||(e.exports=s)}).call(this,n(8))},1240:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1>Imaging Dashboard</h1>\n\n<p class="help"></p>\n\n<div class="filter filter-nohide">\n    <ul class="clearfix">\n        <li class="current"><a href="/admin/imaging">Dashboard</a></li>\n        <li><a href="/admin/imaging/schedule">Imaging Schedules</a></li>\n        <li><a href="/imaging/screen">Crystallisation Screens</a></li>\n        <li><a href="/admin/imaging/preset">Global Presets</a></li>\n        <li><a href="/admin/imaging/param">Beamline Parameters</a></li>\n    </ul>\n</div>\n\n<h1>Imager Status</h1>\n<div class="imagers"></div>\n\n<div class="ctrs"></div>\n\n<h1>Inspections</h1>\n<div class="inspection_filter filter"></div>\n<div class="inspections"></div>';return __p}},1241:function(e,t,n){(function(a,l){var s,i;s=[n(7),n(6),n(49),n(62),n(264),n(1242),n(1243),n(1244),n(18)],void 0===(i=function(e,t,n,s,i,r,c,o){var d=n.extend({getTemplate:function(){return this.model.get("new")?o:c},tagName:"tr",className:function(){return this.model.get("new")?"new":""},events:{"click td":"showScreen","click a.cancel":"cancelScreen","click a.save":"onSubmit"},ui:{name:"input[name=NAME]",global:"select[name=GLOBAL]"},cancelScreen:function(e){e.preventDefault(),this.model.collection.remove(this.model)},setData:function(){this.model.set({NAME:this.ui.name.val(),GLOBAL:this.ui.global.val()})},success:function(e,t,n){this.model.set("new",!1),this.$el.removeClass("new"),this.render()},error:function(e,t,n){app.message("Something went wrong creating this screen, please try again")},showScreen:function(e){a(e.target).closest(".new").length||app.trigger("screen:view",this.model.get("SCREENID"))}}),p=e.ItemView.extend({tagName:"tr",template:l.template('<td colspan="5">No crystallisation screens found</td>')});return GridView=t.Marionette.CompositeView.extend({className:"content",template:r,childView:d,emptyView:p,childViewContainer:"tbody",events:{"click .add":"addScreen"},addScreen:function(e){e.preventDefault(),this.$el.find(".new").length||this.collection.add(new i({new:!0}))},onRender:function(){console.log("render screenadmin"),this.pages=new s({collection:this.collection,noUrl:!0}),this.$el.find(".page_wrap").append(this.pages.render().$el)}})}.apply(t,s))||(e.exports=i)}).call(this,n(8),n(5))},1242:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1>Crystallisation Screens</h1>\n\n<p class="help">This page lists all available crystallisation screens.</p>\n\n<div class="ra"><a href="#" class="add button" title="Click to add a new screen"><i class="fa fa-plus"></i> Add Screen</a></div>\n\n\n<div class="table">\n    <table class="schedules">\n        <thead>\n            <tr>\n                <th>Name</th>\n                <th>Global</th>\n                <th># Groups</th>\n                <th># Components</th>\n                <th>&nbsp;</th>\n            </tr>\n        </thead>\n        \n        <tbody></tbody>\n    </table>\n</div>\n\n<div class="page_wrap"></div>\n';return __p}},1243:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="    <td>"+(null==(__t=NAME)?"":_.escape(__t))+"</td>\n    <td>"+(null==(__t=1==GLOBAL?"Yes":"No")?"":_.escape(__t))+"</td>\n    <td>"+(null==(__t=GROUPS)?"":_.escape(__t))+"</td>\n    <td>"+(null==(__t=COMPONENTS)?"":_.escape(__t))+"</td>\n    <td>&nbsp;</td>\n";return __p}},1244:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <td><input name="NAME" type="text" /></td>\n    <td>\n    \t<select name="GLOBAL">\n    \t\t<option value="1">Yes</option>\n    \t\t<option value="0">No</option>\n    \t</select>\n    </td>\n    <td>&nbsp;</td>\n    <td>&nbsp;</td>\n    <td>\n        <a class="button button-notext save"><i class="fa fa-check"></i> <span>Save Screen</span></a>\n        <a class="button button-notext cancel"><i class="fa fa-times"></i> <span>Cancel</span></a>\n    </td>\n\n';return __p}},1245:function(e,t,n){(function(a){var l,s;l=[n(7),n(6),n(16),n(12),n(31),n(20),n(431),n(265),n(266),n(170),n(267),n(95),n(96),n(1246),n(18)],void 0===(s=function(e,t,n,l,s,i,r,c,o,d,p,_,u,h){n.Cell.extend({});return t.Marionette.LayoutView.extend({className:"content",template:h,regions:{group:".group",plate:".plate"},events:{"click button.submit":"saveGroups"},modelEvents:{"change:CAPACITY":"updatePositions"},initialize:function(e){t.Validation.bind(this),this.collection=new c,this.collection.queryParams.scid=this.model.get("SCREENID"),this.listenTo(this.collection,"change:isSelected",this.setGroup,this),this.collection.fetch(),this.components=new d(null,{state:{pageSize:9999}}),this.components.queryParams.scid=this.model.get("SCREENID"),this.components.fetch(),this.positions=[],this.updatePositions()},updatePositions:function(e){var t=[];a.each(a.range(this.model.get("CAPACITY")),(function(e){t.push({id:e+1,name:e+1})}),this),this.positions=t},setGroup:function(e){var t=this.collection.findWhere({POSITION:e.toString()});if(t)this.groupview.setModel(t);else{var n=new r({SCREENID:this.model.get("SCREENID"),POSITION:e.toString(),new:!0});this.collection.add(n),this.groupview.setModel(n)}},onRender:function(){var e=new i({model:this.model,el:this.$el});e.create("NAME","text"),e.create("CAPACITY","text"),e.create("GLOBAL","select",{data:{Yes:1,No:0}}),this.groupview=new p({components:this.components,editable:app.prop==this.model.get("PROP")}),this.group.show(this.groupview),this.filterview=new s({filters:this.positions,url:!1,className:"fixed"}),this.listenTo(this.filterview,"selected:change",this.setGroup,this),this.plate.show(this.filterview)},saveGroups:function(e){e.preventDefault(),console.log("save groups"),this.collection.save({success:this.onSave.bind(this),error:function(){app.alert({message:"Something went wrong registering the groups"})}})},onSave:function(e){console.log("groups saved",this.collection),this.components.length&&(this.collection.each((function(e){e.set({new:!1});var t=this.components.where({POSITION:e.get("POSITION")});console.log("assigning group ids",e.get("SCREENCOMPONENTGROUPID"),this.components,e.get("POSITION"),t),a.each(t,(function(t){t.set("SCREENCOMPONENTGROUPID",e.get("SCREENCOMPONENTGROUPID"))}))}),this),this.components.save({success:this.onSaveCollection.bind(this),failure:function(){app.alert({message:"Something went wrong registering the group components"})}}))},onSaveCollection:function(){this.components.each((function(e,t){e.set({new:!1})}))}})}.apply(t,l))||(e.exports=s)}).call(this,n(5))},1246:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1>Crystallisation Screen</h1>\n\n<p class="help">This page lists details for the selected crystallisation screen.</p>\n\n<div class="form">\n    <ul>\n\n        <li>\n            <span class="label">Name</span>\n            <span class="NAME">'+(null==(__t=NAME)?"":_.escape(__t))+'</span>\n        </li>\n\n        <li>\n            <span class="label">Global</span>\n            <span class="GLOBAL">'+(null==(__t=1==GLOBAL?"Yes":"No")?"":_.escape(__t))+'</span>\n        </li>\n\n        <li>\n            <span class="label">Capacity</span>\n            <span class="CAPACITY">'+(null==(__t=CAPACITY)?"":_.escape(__t))+'</span>\n        </li>\n\n    </ul>\n\n</div>\n\n<div class="clearfix">\n\n    <div class="left group"></div>\n    <div class="right">\n        <h2>Position</h2>\n        <div class="plate filter"></div>\n    </div>\n\n</div>\n\n<div class="form">\n    <button name="submit" value="1" type="submit" class="button submit"><i class="fa fa-plus"></i> Save All</button>\n</div>';return __p}},1247:function(e,t,n){(function(a,l){var s,i;s=[n(7),n(16),n(174),n(97),n(451),n(450),n(70),n(12),n(15),n(1248),n(1249),n(1250),n(1251),n(1252)],void 0===(i=function(e,t,n,s,i,r,c,o,d,p,_,u,h,m){var b=t.Cell.extend({events:{"click a.save":"save","click a.cancel":"cancel","click a.act":"toggleActive"},toggleActive:function(e){e.preventDefault(),this.model.set({ACTIVE:this.model.get("ACTIVE")?0:1});var t=this;this.model.save(this.model.changedAttributes(),{patch:!0,success:function(){t.displayActive()}})},save:function(e){if(e.preventDefault(),this.model.isValid(!0)){var t=this;this.model.save(this.model.changedAttributes(),{patch:!0,success:function(){t.render()}})}},cancel:function(e){e.preventDefault(),this.model.collection.remove(this.model)},displayActive:function(){parseInt(this.model.get("ACTIVE"))?this.$el.find("a.act").addClass("active"):this.$el.find("a.act").removeClass("active")},render:function(){return this.model.isNew()?this.$el.html('<a href="#" class="button  button-notext save"><i class="fa fa-check"></i> <span>Save</span></a> <a href="#" class="button  button-notext cancel"><i class="fa fa-times"></i> <span>Remove</span></a>'):this.$el.html('<a href="#" class="button button-notext act"><i class="fa fa-power-off"></i> <span>Active</span></a>'),this.displayActive(),this}}),f=t.Cell.extend({events:{"click a.save":"save","click a.cancel":"cancel"},save:function(e){if(e.preventDefault(),this.model.isValid(!0)){var t=this;this.model.save(this.model.changedAttributes(),{patch:!0,success:function(){t.render()}})}},cancel:function(e){e.preventDefault(),this.model.collection.remove(this.model)},render:function(){return this.$el.empty(),this.model.isNew()&&this.$el.html('<a href="#" class="button  button-notext save"><i class="fa fa-check"></i> <span>Save</span></a> <a href="#" class="button  button-notext cancel"><i class="fa fa-times"></i> <span>Remove</span></a>'),this}}),E=d.ValidatedTemplateCell.extend({events:a.extend({},d.ValidatedTemplateCell.prototype.events,{"click a.locked":"doUnlock","click a.unlocked":"doLock"}),initialize:function(e){E.__super__.initialize.call(this,e)},render:function(){return this.$el.empty(),this.bindModel(),this.model.isNew()?this.doUnlock():this.doLock(),this},doUnlock:function(e){e&&e.preventDefault(),this.$el.html(_(this.model.toJSON()))},doLock:function(e){e&&e.preventDefault(),this.$el.html(u(this.model.toJSON()))}}),g=d.ValidatedTemplateCell.extend({events:a.extend({},d.ValidatedTemplateCell.prototype.events,{"click a.locked":"doUnlock","click a.unlocked":"doLock"}),initialize:function(e){E.__super__.initialize.call(this,e)},render:function(){return this.$el.empty(),this.bindModel(),this.model.isNew()?this.doUnlock():this.doLock(),this},doUnlock:function(e){e&&e.preventDefault(),this.$el.html(h(this.model.toJSON()))},doLock:function(e){e&&e.preventDefault(),this.$el.html(m(this.model.toJSON()))}}),v=t.Cell.extend({render:function(){return this.$el.empty(),this.model.isNew()||(this.$el.html(m(this.model.toJSON())),this.$el.find("a.locked").hide()),this}});return e.LayoutView.extend({className:"content",template:p,regions:{rprms:".params",rdets:".detectors"},events:{"click a.add":"addBeamlineSetup","click a.addd":"addDetector"},addBeamlineSetup:function(e){e.preventDefault(),this.params.add(new n)},addDetector:function(e){e.preventDefault(),this.detectors.add(new i)},initialize:function(e){this._ready=[],this.beamlines=new c,this._ready.push(this.beamlines.fetch()),this.params=new s,this._ready.push(this.params.fetch()),this.detectors=new r,this._ready.push(this.detectors.fetch()),this.listenTo(this.params,"backgrid:edited",this.saveModel),this.listenTo(this.detectors,"backgrid:edited",this.saveModel)},saveModel:function(e,t){console.log("model changed",arguments),e.isNew()||e.save(a.clone(e.attributes),{patch:!0})},onRender:function(){l.when.apply(l,this._ready).done(this.doOnRender.bind(this))},doOnRender:function(){this.rprms.show(new o({tableClass:"subsamples",collection:this.params,columns:[{name:"BEAMLINENAME",label:"Beamline",cell:d.SelectInputCell,editable:!0,options:this.beamlines},{name:"SETUPDATE",label:"Created",cell:"string",editable:!1},{label:"Beamline Limits",cell:E,editable:!1},{name:"DETECTORID",label:"Detector",cell:d.SelectInputCell,editable:!0,options:this.detectors},{label:"Limits",cell:v,editable:!1},{name:"SESSIONS",label:"Sessions",cell:"string",editable:!1},{label:"",cell:b,editable:!1}],backgrid:{emptyText:"No Beamline Parameters Available"}})),this.rdets.show(new o({tableClass:"subsamples",collection:this.detectors,columns:[{name:"DETECTORMANUFACTURER",label:"Manufacturer",cell:d.ValidatedCell,editable:!0},{name:"DETECTORMODEL",label:"Model",cell:d.ValidatedCell,editable:!0},{name:"DETECTORTYPE",label:"Type",cell:d.ValidatedCell,editable:!0},{name:"DETECTORSERIALNUMBER",label:"Serial",cell:d.ValidatedCell,editable:!0},{name:"SENSORTHICKNESS",label:"Sensor Thickness (um)",cell:d.ValidatedCell,editable:!0},{label:"Detector Limits",cell:g,editable:!1},{name:"BLSETUPS",label:"Setups",cell:"string",editable:!1},{name:"BEAMLINES",label:"Beamlines",cell:"string",editable:!1},{name:"DPS",label:"Plans",cell:"string",editable:!1},{name:"DCS",label:"DCs",cell:"string",editable:!1},{label:"",cell:f,editable:!1}],backgrid:{emptyText:"No Detectors Available"}}))}})}.apply(t,s))||(e.exports=i)}).call(this,n(5),n(8))},1248:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="filter filter-nohide">\n    <ul class="clearfix">\n        <li><a href="/admin/imaging">Dashboard</a></li>\n        <li><a href="/admin/imaging/schedule">Imaging Schedules</a></li>\n        <li><a href="/imaging/screen">Crystallisation Screens</a></li>\n        <li><a href="/admin/imaging/preset">Global Presets</a></li>\n        <li class="current"><a href="/admin/imaging/param">Beamline Parameters</a></li>\n    </ul>\n</div>\n\n\n<h1>Beamline Parameters</h1>\n\n<p>Only one set of beamline parameters can be active for each beamline and detector combination at a time</p>\n\n<a href="#" class="button r add"><i class="fa fa-plus"></i> <span>Add Beamline Parameters</span></a>\n<div class="params"></div>\n\n\n<h1>Detectors</h1>\n\n<p>One or more detectors can exist for each beamline</p>\n\n<a href="#" class="button r addd"><i class="fa fa-plus"></i> <span>Add Detector</span></a>\n<div class="detectors"></div>';return __p}},1249:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a href="#" class="unlocked button"><i class="fa fa-unlock"></i></a>\n<table>\n    <tr>\n        <td class="renderable">Beamsize: </td>\n        <td class="renderable">\n            x: <input type="text" name="BEAMSIZEXMIN" value="'+(null==(__t=BEAMSIZEXMIN)?"":_.escape(__t))+'" /> - <input type="text" name="BEAMSIZEXMAX" value="'+(null==(__t=BEAMSIZEXMAX)?"":_.escape(__t))+'" />  <br /> \n            y: <input type="text" name="BEAMSIZEYMIN" value="'+(null==(__t=BEAMSIZEYMIN)?"":_.escape(__t))+'" /> - <input type="text" name="BEAMSIZEYMAX" value="'+(null==(__t=BEAMSIZEYMAX)?"":_.escape(__t))+'" />\n        </td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">Boxsize: </td>\n        <td class="renderable">\n            x: <input type="text" name="BOXSIZEXMIN" value="'+(null==(__t=BOXSIZEXMIN)?"":_.escape(__t))+'" /> - <input type="text" name="BOXSIZEXMAX" value="'+(null==(__t=BOXSIZEXMAX)?"":_.escape(__t))+'" /> <br > \n            y: <input type="text" name="BOXSIZEYMIN" value="'+(null==(__t=BOXSIZEYMIN)?"":_.escape(__t))+'" /> - <input type="text" name="BOXSIZEYMAX" value="'+(null==(__t=BOXSIZEYMAX)?"":_.escape(__t))+'" />\n        </td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Omega;: </td>\n        <td class="renderable"><input type="text" name="OMEGAMIN" value="'+(null==(__t=OMEGAMIN)?"":_.escape(__t))+'" /> - <input type="text" name="OMEGAMAX" value="'+(null==(__t=OMEGAMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Kappa;: </td>\n        <td class="renderable"><input type="text" name="KAPPAMIN" value="'+(null==(__t=KAPPAMIN)?"":_.escape(__t))+'" /> - <input type="text" name="KAPPAMAX" value="'+(null==(__t=KAPPAMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Phi;: </td>\n        <td class="renderable"><input type="text" name="PHIMIN" value="'+(null==(__t=PHIMIN)?"":_.escape(__t))+'" /> - <input type="text" name="PHIMAX" value="'+(null==(__t=PHIMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Axis Osc Range: </td>\n        <td class="renderable"><input type="text" name="GONIOSTATMINOSCILLATIONWIDTH" value="'+(null==(__t=GONIOSTATMINOSCILLATIONWIDTH)?"":_.escape(__t))+'" /> - <input type="text" name="GONIOSTATMAXOSCILLATIONWIDTH" value="'+(null==(__t=GONIOSTATMAXOSCILLATIONWIDTH)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Exposure Time: </td>\n        <td class="renderable"><input type="text" name="MINEXPOSURETIMEPERIMAGE" value="'+(null==(__t=MINEXPOSURETIMEPERIMAGE)?"":_.escape(__t))+'" /> - <input type="text" name="MAXEXPOSURETIMEPERIMAGE" value="'+(null==(__t=MAXEXPOSURETIMEPERIMAGE)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">s</td>\n    </tr>\n    <tr>\n        <td class="renderable">Number of Images: </td>\n        <td class="renderable"><input type="text" name="NUMBEROFIMAGESMIN" value="'+(null==(__t=NUMBEROFIMAGESMIN)?"":_.escape(__t))+'" /> - <input type="text" name="NUMBEROFIMAGESMAX" value="'+(null==(__t=NUMBEROFIMAGESMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">s</td>\n    </tr>\n    <tr>\n        <td class="renderable">Energy: </td>\n        <td class="renderable"><input type="text" name="ENERGYMIN" value="'+(null==(__t=ENERGYMIN)?"":_.escape(__t))+'" /> - <input type="text" name="ENERGYMAX" value="'+(null==(__t=ENERGYMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">eV</td>\n    </tr>\n    <tr>\n        <td class="renderable">Transmission: </td>\n        <td class="renderable"><input type="text" name="MINTRANSMISSION" value="'+(null==(__t=MINTRANSMISSION)?"":_.escape(__t))+'" /> - <input type="text" name="MAXTRANSMISSION" value="'+(null==(__t=MAXTRANSMISSION)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">%</td>\n    </tr>\n    <tr>\n        <td class="renderable">Monochromator Bandwidth: </td>\n        <td class="renderable"><input type="text" name="MONOBANDWIDTHMIN" value="'+(null==(__t=MONOBANDWIDTHMIN)?"":_.escape(__t))+'" /> - <input type="text" name="MONOBANDWIDTHMAX" value="'+(null==(__t=MONOBANDWIDTHMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">%</td>\n    </tr>\n    <tr>\n        <td class="renderable">Spherical Aberration: </td>\n        <td class="renderable"><input type="text" name="CS" value="'+(null==(__t=CS)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&nbsp;</td>\n    </tr>\n</table>\n';return __p}},1250:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a href="#" class="locked button"><i class="fa fa-lock"></i></a>\n<table>\n    <tr>\n        <td class="renderable">Beamsize: </td>\n        <td class="renderable">x: '+(null==(__t=BEAMSIZEXMIN)?"":_.escape(__t))+" - "+(null==(__t=BEAMSIZEXMAX)?"":_.escape(__t))+"  y: "+(null==(__t=BEAMSIZEYMIN)?"":_.escape(__t))+" - "+(null==(__t=BEAMSIZEYMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">Boxsize: </td>\n        <td class="renderable">x: '+(null==(__t=BOXSIZEXMIN)?"":_.escape(__t))+" - "+(null==(__t=BOXSIZEXMAX)?"":_.escape(__t))+"  y: "+(null==(__t=BOXSIZEYMIN)?"":_.escape(__t))+" - "+(null==(__t=BOXSIZEYMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Omega;: </td>\n        <td class="renderable">'+(null==(__t=OMEGAMIN)?"":_.escape(__t))+" - "+(null==(__t=OMEGAMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Kappa;: </td>\n        <td class="renderable">'+(null==(__t=KAPPAMIN)?"":_.escape(__t))+" - "+(null==(__t=KAPPAMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">&Phi;: </td>\n        <td class="renderable">'+(null==(__t=PHIMIN)?"":_.escape(__t))+" - "+(null==(__t=PHIMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Axis Osc Range: </td>\n        <td class="renderable">'+(null==(__t=GONIOSTATMINOSCILLATIONWIDTH)?"":_.escape(__t))+" - "+(null==(__t=GONIOSTATMAXOSCILLATIONWIDTH)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Exposure Time: </td>\n        <td class="renderable">'+(null==(__t=MINEXPOSURETIMEPERIMAGE)?"":_.escape(__t))+" - "+(null==(__t=MAXEXPOSURETIMEPERIMAGE)?"":_.escape(__t))+'</td>\n        <td class="renderable">s</td>\n    </tr>\n    <tr>\n        <td class="renderable">Number of Images: </td>\n        <td class="renderable">'+(null==(__t=NUMBEROFIMAGESMIN)?"":_.escape(__t))+" - "+(null==(__t=NUMBEROFIMAGESMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">s</td>\n    </tr>\n    <tr>\n        <td class="renderable">Energy: </td>\n        <td class="renderable">'+(null==(__t=ENERGYMIN)?"":_.escape(__t))+" - "+(null==(__t=ENERGYMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">eV</td>\n    </tr>\n    <tr>\n        <td class="renderable">Transmission: </td>\n        <td class="renderable">'+(null==(__t=MINTRANSMISSION)?"":_.escape(__t))+" - "+(null==(__t=MAXTRANSMISSION)?"":_.escape(__t))+'</td>\n        <td class="renderable">%</td>\n    </tr>\n    <tr>\n        <td class="renderable">Monochromator Bandwidth: </td>\n        <td class="renderable">'+(null==(__t=MONOBANDWIDTHMIN)?"":_.escape(__t))+" - "+(null==(__t=MONOBANDWIDTHMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Spherical Aberration: </td>\n        <td class="renderable">'+(null==(__t=CS)?"":_.escape(__t))+'</td>\n        <td class="renderable">&nbsp;</td>\n    </tr>\n</table>\n';return __p}},1251:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a href="#" class="unlocked button"><i class="fa fa-unlock"></i></a>\n<table>\n    <tr>\n        <td class="renderable">Distance: </td>\n        <td class="renderable"><input type="text" name="DETECTORDISTANCEMIN" value="'+(null==(__t=DETECTORDISTANCEMIN)?"":_.escape(__t))+'" />  - <input type="text" name="DETECTORDISTANCEMAX" value="'+(null==(__t=DETECTORDISTANCEMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">mm</td>\n    </tr>\n    <tr>\n        <td class="renderable">Resolution: </td>\n        <td class="renderable"><input type="text" name="DETECTORMAXRESOLUTION" value="'+(null==(__t=DETECTORMAXRESOLUTION)?"":_.escape(__t))+'" /> - <input type="text" name="DETECTORMINRESOLUTION" value="'+(null==(__t=DETECTORMINRESOLUTION)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&#197;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Roll: </td>\n        <td class="renderable"><input type="text" name="DETECTORROLLMIN" value="'+(null==(__t=DETECTORROLLMIN)?"":_.escape(__t))+'" /> - <input type="text" name="DETECTORROLLMAX" value="'+(null==(__t=DETECTORROLLMAX)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Pixel Size: </td>\n        <td class="renderable"><input type="text" name="DETECTORPIXELSIZEHORIZONTAL" value="'+(null==(__t=DETECTORPIXELSIZEHORIZONTAL)?"":_.escape(__t))+'" />  x <input type="text" name="DETECTORPIXELSIZEVERTICAL" value="'+(null==(__t=DETECTORPIXELSIZEVERTICAL)?"":_.escape(__t))+'" /></td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">Number of Pixels</td>\n        <td class="renderable"><input type="text" name="NUMBEROFPIXELSX" value="'+(null==(__t=NUMBEROFPIXELSX)?"":_.escape(__t))+'" /> x <input type="text" name="NUMBEROFPIXELSY" value="'+(null==(__t=NUMBEROFPIXELSY)?"":_.escape(__t))+'" /></td>\n        <td class="renderable"></td>\n    </tr>\n</table>\n';return __p}},1252:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a href="#" class="locked button"><i class="fa fa-lock"></i></a>\n<table>\n    <tr>\n        <td class="renderable">Distance: </td>\n        <td class="renderable">'+(null==(__t=DETECTORDISTANCEMIN)?"":_.escape(__t))+" - "+(null==(__t=DETECTORDISTANCEMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">mm</td>\n    </tr>\n    <tr>\n        <td class="renderable">Resolution: </td>\n        <td class="renderable">'+(null==(__t=DETECTORMAXRESOLUTION)?"":_.escape(__t))+" - "+(null==(__t=DETECTORMINRESOLUTION)?"":_.escape(__t))+'</td>\n        <td class="renderable">&#197;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Roll: </td>\n        <td class="renderable">'+(null==(__t=DETECTORROLLMIN)?"":_.escape(__t))+" - "+(null==(__t=DETECTORROLLMAX)?"":_.escape(__t))+'</td>\n        <td class="renderable">&deg;</td>\n    </tr>\n    <tr>\n        <td class="renderable">Pixel Size: </td>\n        <td class="renderable">'+(null==(__t=DETECTORPIXELSIZEHORIZONTAL)?"":_.escape(__t))+" x "+(null==(__t=DETECTORPIXELSIZEVERTICAL)?"":_.escape(__t))+'</td>\n        <td class="renderable">&micro;m</td>\n    </tr>\n    <tr>\n        <td class="renderable">Number of Pixels</td>\n        <td class="renderable">'+(null==(__t=NUMBEROFPIXELSX)?"":_.escape(__t))+" x "+(null==(__t=NUMBEROFPIXELSY)?"":_.escape(__t))+'</td>\n        <td class="renderable"></td>\n    </tr>\n</table>\n';return __p}},1253:function(e,t,n){(function(a,l){var s,i;s=[n(7),n(6),n(16),n(439),n(270),n(12),n(15),n(254),n(443),n(444),n(445),n(1254),n(440),n(441),n(442)],void 0===(i=function(e,t,n,s,i,r,c,o,d,p,_,u,h,m,b){var f=n.Cell.extend({events:{"click a.save":"save","click a.cancel":"cancel"},save:function(e){if(e.preventDefault(),this.model.isValid(!0)&&this.model.get("_valid")){var t=this;this.model.save({},{success:function(){t.render()}})}},cancel:function(e){e.preventDefault(),this.model.collection.remove(this.model)},render:function(){return this.$el.empty(),this.model.isNew()&&this.$el.html('<a href="#" class="button save"><i class="fa fa-save"></i></a> <a href="#" class="button cancel"><i class="fa fa-times"></i></a>'),this}}),E=n.Cell.extend({plans:{SAD:d,MESH:p,XFE:_},events:{"change input":"updateModel","blur input":"updateModel","keyup input":"updateModel","change select":"updateModel"},updateModel:function(e){console.log("up mod",a(e.target).attr("name")),this.model.set(a(e.target).attr("name"),a(e.target).val()),this.plan.set(this.model.toJSON()),this.validate({attr:a(e.target).attr("name"),val:a(e.target).val()}),this.preSave()},preSave:function(){this.plan.isValid(!0)?this.model.set("_valid",!0):this.model.set("_valid",!1)},validate:function(e){var t=this.plan.preValidate(e.attr,e.val),n=this.$el.find("[name="+e.attr+"]");t?this.invalid(n,t):this.valid(n)},invalid:function(e,t){a(e).removeClass("fvalid").addClass("ferror"),a(e).siblings("span.errormessage").length?a(e).siblings("span.errormessage").text(t):a(e).after('<span class="errormessage ferror">'+t+"</span>")},valid:function(e){a(e).removeClass("ferror").addClass("fvalid").siblings("span.errormessage").remove()},initialize:function(e){E.__super__.initialize.call(this,e),this.listenTo(this.model,"change:EXPERIMENTKIND",this.render,this),this.listenTo(this.model,"refresh",this.render,this),this.preSave=l.debounce(this.preSave,1e3)},bindModel:function(){this.model.get("EXPERIMENTKIND")in this.plans?this.plan=new(this.plans[this.model.get("EXPERIMENTKIND")]):this.plan=new i,t.Validation.unbind(this),t.Validation.bind(this,{model:this.plan,selector:"name",valid:function(e,t){e.valid(e.$el.find('[name="'+t+'"]'))},invalid:function(e,t,n){e.invalid(e.$el.find('[name="'+t+'"]'),n)}}),this.plan.set(this.model.toJSON()),this.listenTo(this.plan,"computed:changed",this.updateComputed)},updateComputed:function(){l.each(this.plan.computed(),(function(e){this.$el.find("[name="+e+"]").val(this.plan.get(e)).trigger("change")}),this)},render:function(e){console.log("render cell exp");var t={SAD:h,MESH:m,XFE:b};return this.$el.empty(),this.model.get("EXPERIMENTKIND")in t&&this.$el.html(t[this.model.get("EXPERIMENTKIND")](this.model.toJSON())),this.bindModel(),this.updateComputed(),this}}),g=n.Cell.extend({events:{"change select":"updateModel"},updateModel:function(){this.model.set("EXPERIMENTKIND",this.$el.find("select").val())},types:[{name:"Point Collection",type:"SAD"},{name:"Fluorescence",type:"XFE"},{name:"Grid Scan",type:"MESH"}],render:function(){var e="";return l.each(this.types,(function(t){e+='<option value="'+t.type+'">'+t.name+"</option>"})),this.$el.html('<select name="EXPERIMENTKIND">'+e+"</select>"),this.$el.find("select").val(this.model.get("EXPERIMENTKIND")),this}});return e.LayoutView.extend({className:"content",template:u,regions:{rprs:".presets"},events:{"click a.add":"addPlan"},addPlan:function(e){e.preventDefault(),this.plans.add(new i({EXPERIMENTKIND:"SAD"}))},templateHelpers:function(){return{PRESETPROPOSAL:app.options.get("preset_proposal")}},initialize:function(e){this.beamlines=new o(null,{ty:app.type}),this.beamlines.fetch(),this.plans=new s,this.plans.fetch(),this.listenTo(this.plans,"change",this.savePlan)},savePlan:function(e,t){console.log("model changed",arguments),e.isNew()||e.save(e.changedAttributes(),{patch:!0})},onRender:function(){this.rprs.show(new r({collection:this.plans,tableClass:"subsamples",columns:[{name:"BEAMLINENAME",label:"Beamline",cell:c.SelectInputCell,editable:!0,options:this.beamlines},{name:"COMMENTS",label:"Name",cell:c.ValidatedCell,editable:!0},{label:"Exp. Type",cell:g,editable:!1},{label:"Parameters",cell:E,editable:!1},{label:"",cell:f,editable:!1}],backgrid:{emptyText:"No preset defined"}}))}})}.apply(t,s))||(e.exports=i)}).call(this,n(8),n(5))},1254:function(module,exports,__webpack_require__){var _=__webpack_require__(5);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="filter filter-nohide">\n    <ul class="clearfix">\n        <li><a href="/admin/imaging">Dashboard</a></li>\n        <li><a href="/admin/imaging/schedule">Imaging Schedules</a></li>\n        <li><a href="/imaging/screen">Crystallisation Screens</a></li>\n        <li class="current"><a href="/admin/imaging/preset">Global Presets</a></li>\n        <li><a href="/admin/imaging/param">Beamline Parameters</a></li>\n    </ul>\n</div>\n\n\n<h1>Global Presets</h1>\n\nGlobal presets are currently being saved into &quot;'+(null==(__t=PRESETPROPOSAL)?"":_.escape(__t))+'&quot;\n\n<a href="#" class="button r add"><i class="fa fa-plus"></i> <span>Add Preset</span></a>\n<div class="presets"></div>';return __p}},70:function(e,t,n){(function(a){var l,s;l=[n(6),n(14)],void 0===(s=function(e,t){var n=e.Model.extend({idAttribute:"NAME"});return e.Collection.extend(a.extend({},t,{model:n,url:"/fault/bls",keyAttribute:"NAME",valueAttribute:"NAME"}))}.apply(t,l))||(e.exports=s)}).call(this,n(5))}}]);